<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JPA 028ãƒ‡ã‚£ãƒ“ã‚¸ãƒ§ãƒ³ ãƒ©ãƒ³ã‚­ãƒ³ã‚°</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background-color: #f4f4f9; }
        .container { max-width: 600px; margin: auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        h1 { color: #004d99; border-bottom: 3px solid #004d99; padding-bottom: 10px; text-align: center; }
        .update-info { text-align: right; font-size: 0.9em; color: #555; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background-color: #004d99; color: white; font-weight: bold; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #f0f0f0; }
        .rank { text-align: center; font-weight: bold; }
        .points { text-align: right; font-weight: bold; color: #cc0000; }
        .gold { background-color: #ffd700; }
        .silver { background-color: #c0c0c0; }
        .bronze { background-color: #cd7f32; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ± JPA 028ãƒ‡ã‚£ãƒ“ã‚¸ãƒ§ãƒ³ ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h1>
        <div class="update-info">
            <span id="checked-date">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­ã§ã™...</span>
            <span id="source-link"></span>
        </div>
        <table>
            <thead>
                <tr>
                    <th>é †ä½</th>
                    <th>ãƒãƒ¼ãƒ å (Team No.)</th>
                    <th class="points">ãƒã‚¤ãƒ³ãƒˆåˆè¨ˆ</th>
                </tr>
            </thead>
            <tbody id="ranking-body">
                <tr><td colspan="3" style="text-align: center;">ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ä¸­...</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const rankingBody = document.getElementById('ranking-body');
            const updateDateSpan = document.getElementById('update-date');
            const sourceLinkSpan = document.getElementById('source-link');
            
            // Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ç”Ÿæˆã•ã‚ŒãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€
            fetch('ranking_data.json?v=' + new Date().getTime()) // ã‚­ãƒ£ãƒƒã‚·ãƒ¥å¯¾ç­–
                .then(response => {
                    if (!response.ok) {
                        throw new Error('ranking_data.json ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
                    }
                    return response.json();
                })
                .then(data => {
                    rankingBody.innerHTML = ''; // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã‚’ã‚¯ãƒªã‚¢
                    
                    // 1. ãƒã‚§ãƒƒã‚¯æ—¥æ™‚ã‚’è¡¨ç¤º
                    const checked = data.last_checked || null;
                    if (checked) {
                        document.getElementById('checked-date').textContent = `æœ€çµ‚ãƒã‚§ãƒƒã‚¯æ—¥æ™‚: ${checked} `;
                    } else {
                        document.getElementById('checked-date').textContent = 'æœ€çµ‚ãƒã‚§ãƒƒã‚¯æ—¥æ™‚: ä¸æ˜';
                    }
                    document.getElementById('source-link').innerHTML = data.source_pdf ? `(<a href="${data.source_pdf}" target="_blank">PDFã‚½ãƒ¼ã‚¹</a>)` : '';

                    // 2. ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ã‚’ç”Ÿæˆ
                    data.ranking.forEach((team, index) => {
                        const rank = index + 1;
                        const row = rankingBody.insertRow();
                        
                        let rankClass = '';
                        if (rank === 1) rankClass = 'gold';
                        else if (rank === 2) rankClass = 'silver';
                        else if (rank === 3) rankClass = 'bronze';

                        row.innerHTML = `
                            <td class="rank ${rankClass}">${rank}</td>
                            <td>${team.team_name} (No.${team.team_id})</td>
                            <td class="points">${team.points}</td>
                        `;
                    });
                })
                .catch(error => {
                    console.error('ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã‚¨ãƒ©ãƒ¼:', error);
                    rankingBody.innerHTML = '<tr><td colspan="3" style="color: red; text-align: center;">ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</td></tr>';
                    updateDateSpan.textContent = 'æœ€çµ‚æ›´æ–°æ—¥æ™‚: ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚¨ãƒ©ãƒ¼';
                });
        });
    </script>
</body>
</html>
